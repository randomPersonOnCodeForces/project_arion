<?xml version="1.0" ?>
<sdf version="1.6">
  <world name="arion_warehouse">
    <!-- Physics configuration -->
    <gravity>0 0 -9.8</gravity>
    <physics default="0" name="default_physics" type="ode">
      <max_step_size>0.001</max_step_size>
      <real_time_factor>1.0</real_time_factor>
      <real_time_update_rate>1000</real_time_update_rate>
    </physics>

    <!-- Gazebo plugins for Ignition Gazebo -->
    <plugin
      filename="libignition-gazebo-physics-system.so"
      name="ignition::gazebo::systems::Physics">
    </plugin>
    <plugin
      filename="libignition-gazebo-user-commands-system.so"
      name="ignition::gazebo::systems::UserCommands">
    </plugin>
    <plugin
      filename="libignition-gazebo-scene-broadcaster-system.so"
      name="ignition::gazebo::systems::SceneBroadcaster">
    </plugin>

    <!-- Lighting -->
    <light type="directional" name="sun">
      <cast_shadows>true</cast_shadows>
      <pose>0 0 10 0 0 0</pose>
      <diffuse>0.8 0.8 0.8 1</diffuse>
      <specular>0.2 0.2 0.2 1</specular>
      <attenuation>
        <range>1000</range>
        <constant>0.9</constant>
        <linear>0.01</linear>
        <quadratic>0.001</quadratic>
      </attenuation>
      <direction>-0.5 0.1 -0.9</direction>
    </light>

    <!-- AWS Warehouse Roof -->
    <model name="aws_robomaker_warehouse_RoofB_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_RoofB_01</uri>
      </include>
      <pose>0.0 0.0 0 0 0 0</pose>
    </model>

    <!-- AWS Warehouse Walls -->
    <model name="aws_robomaker_warehouse_WallB_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_WallB_01</uri>
      </include>
      <pose>0.0 0.0 0 0 0 0</pose>
    </model>

    <!-- AWS Warehouse Ground -->
    <model name="aws_robomaker_warehouse_GroundB_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_GroundB_01</uri>
      </include>
      <pose>0.0 0.0 0 0 0 0</pose>
    </model>

    <!-- Shelves (East wall) -->
    <model name="aws_robomaker_warehouse_ShelfF_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfF_01</uri>
      </include>
      <pose>-5.795143 -0.956635 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfE_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfE_01</uri>
      </include>
      <pose>4.73156 0.57943 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfE_01_002">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfE_01</uri>
      </include>
      <pose>4.73156 -4.827049 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfE_01_003">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfE_01</uri>
      </include>
      <pose>4.73156 -8.6651 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfD_01_001">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfD_01</uri>
      </include>
      <pose>4.73156 -1.242668 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfD_01_002">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfD_01</uri>
      </include>
      <pose>4.73156 -3.038551 0 0 0 0</pose>
    </model>

    <model name="aws_robomaker_warehouse_ShelfD_01_003">
      <include>
        <uri>model://aws_robomaker_warehouse_ShelfD_01</uri>
      </include>
      <pose>4.73156 -6.750542 0 0 0 0</pose>
    </model>

    <!-- TurtleBot3 Waffle Pi Robot -->
    <model name="turtlebot3_waffle_pi">
      <pose>0.0 0.0 0.0 0 0 0</pose>
      <static>false</static>

      <!-- Base -->
      <link name="base_footprint"/>

      <joint name="base_footprint_joint" type="revolute">
        <pose>0 0 0 0 0 0</pose>
        <child>base_link</child>
        <parent>base_footprint</parent>
        <axis>
          <xyz>0 0 1</xyz>
          <limit>
            <lower>-1.57</lower>
            <upper>1.57</upper>
            <effort>150</effort>
            <velocity>3.0</velocity>
          </limit>
        </axis>
      </joint>

      <link name="base_link">
        <visual>
          <pose>0 0 0.032 0 0 0</pose>
          <geometry>
            <box size="0.265 0.265 0.086"/>
          </geometry>
          <material name="darkgray">
            <color rgba="0.2 0.2 0.2 1.0"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0.032 0 0 0</pose>
          <geometry>
            <box size="0.265 0.265 0.086"/>
          </geometry>
        </collision>
        <inertial>
          <mass>1.3</mass>
          <pose>0 0 0.032 0 0 0</pose>
          <inertia>
            <ixx>0.001</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.001</iyy>
            <iyz>0</iyz>
            <izz>0.001</izz>
          </inertia>
        </inertial>
      </link>

      <!-- Left Wheel -->
      <joint name="wheel_left_joint" type="continuous">
        <parent>base_link</parent>
        <child>wheel_left_link</child>
        <pose>0 0.08 0 -1.57 0 0</pose>
        <axis>
          <xyz>0 0 1</xyz>
          <limit>
            <effort>100</effort>
            <velocity>6.28</velocity>
          </limit>
        </axis>
      </joint>

      <link name="wheel_left_link">
        <visual>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <cylinder length="0.025" radius="0.033"/>
          </geometry>
          <material name="black">
            <color rgba="0 0 0 1.0"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <cylinder length="0.025" radius="0.033"/>
          </geometry>
        </collision>
        <inertial>
          <mass>0.1</mass>
          <pose>0 0 0 1.57 0 0</pose>
          <inertia>
            <ixx>0.00001</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00001</iyy>
            <iyz>0</iyz>
            <izz>0.00001</izz>
          </inertia>
        </inertial>
      </link>

      <!-- Right Wheel -->
      <joint name="wheel_right_joint" type="continuous">
        <parent>base_link</parent>
        <child>wheel_right_link</child>
        <pose>0 -0.08 0 -1.57 0 0</pose>
        <axis>
          <xyz>0 0 1</xyz>
          <limit>
            <effort>100</effort>
            <velocity>6.28</velocity>
          </limit>
        </axis>
      </joint>

      <link name="wheel_right_link">
        <visual>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <cylinder length="0.025" radius="0.033"/>
          </geometry>
          <material name="black">
            <color rgba="0 0 0 1.0"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <cylinder length="0.025" radius="0.033"/>
          </geometry>
        </collision>
        <inertial>
          <mass>0.1</mass>
          <pose>0 0 0 1.57 0 0</pose>
          <inertia>
            <ixx>0.00001</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.00001</iyy>
            <iyz>0</iyz>
            <izz>0.00001</izz>
          </inertia>
        </inertial>
      </link>

      <!-- Caster Wheel -->
      <joint name="caster_joint" type="fixed">
        <parent>base_link</parent>
        <child>caster_link</child>
        <pose>-0.069 0 -0.004 -1.57 0 0</pose>
      </joint>

      <link name="caster_link">
        <visual>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <sphere radius="0.016"/>
          </geometry>
          <material name="black">
            <color rgba="0 0 0 1.0"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0 1.57 0 0</pose>
          <geometry>
            <sphere radius="0.016"/>
          </geometry>
        </collision>
        <inertial>
          <mass>0.05</mass>
          <pose>0 0 0 1.57 0 0</pose>
          <inertia>
            <ixx>0.000001</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.000001</iyy>
            <iyz>0</iyz>
            <izz>0.000001</izz>
          </inertia>
        </inertial>
      </link>

      <!-- Lidar Sensor -->
      <joint name="lidar_joint" type="fixed">
        <parent>base_link</parent>
        <child>lidar_link</child>
        <pose>0 0 0.068 0 0 0</pose>
      </joint>

      <link name="lidar_link">
        <visual>
          <pose>0 0 0 0 0 0</pose>
          <geometry>
            <cylinder length="0.04" radius="0.04"/>
          </geometry>
          <material name="red">
            <color rgba="1.0 0 0 1.0"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0 0 0 0</pose>
          <geometry>
            <cylinder length="0.04" radius="0.04"/>
          </geometry>
        </collision>
        <inertial>
          <mass>0.125</mass>
          <pose>0 0 0 0 0 0</pose>
          <inertia>
            <ixx>0.000001</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.000001</iyy>
            <iyz>0</iyz>
            <izz>0.000001</izz>
          </inertia>
        </inertial>
      </link>

      <!-- Lidar Sensor Plugin -->
      <plugin
        filename="libgazebo_ros_ray_sensor.so"
        name="lidar">
        <ros>
          <remapping>~/out:=scan</remapping>
        </ros>
        <output_type>sensor_msgs/LaserScan</output_type>
        <frame_name>lidar_link</frame_name>
        <range>
          <min>0.08</min>
          <max>3.5</max>
        </range>
        <resolution>0.015</resolution>
        <noise>
          <type>gaussian</type>
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </plugin>

      <!-- Odometry plugin for wheel encoders -->
      <plugin
        filename="libgazebo_ros_diff_drive.so"
        name="differential_drive">
        <ros>
          <namespace>/</namespace>
        </ros>
        <update_rate>30</update_rate>
        <left_joint>wheel_left_joint</left_joint>
        <right_joint>wheel_right_joint</right_joint>
        <wheel_separation>0.16</wheel_separation>
        <wheel_diameter>0.066</wheel_diameter>
        <max_wheel_torque>20</max_wheel_torque>
        <max_wheel_acceleration>1.0</max_wheel_acceleration>
        <command_topic>cmd_vel</command_topic>
        <publication_topic_prefix>odom</publication_topic_prefix>
        <odometry_frame>odom</odometry_frame>
        <robot_base_frame>base_footprint</robot_base_frame>
      </plugin>

      <!-- IMU Plugin (optional, but useful) -->
      <plugin
        filename="libgazebo_ros_imu_sensor.so"
        name="imu_plugin">
        <ros>
          <namespace>/</namespace>
          <remapping>~/out:=imu</remapping>
        </ros>
        <service_name>imu_service</service_name>
        <sensor_name>imu_sensor</sensor_name>
        <always_on>true</always_on>
        <update_rate>100</update_rate>
        <visualize>true</visualize>
        <imu_topic>/imu</imu_topic>
      </plugin>

    </model>

    <!-- AI Academy Pallet (Custom Object) -->
    <model name="ai_academy_pallet">
      <pose>2.0 3.0 0.0 0 0 0</pose>
      <static>false</static>
      <link name="pallet_link">
        <visual>
          <pose>0 0 0.1 0 0 0</pose>
          <geometry>
            <box size="0.5 0.5 0.2"/>
          </geometry>
          <material name="blue">
            <color rgba="0.0 0.0 1.0 0.8"/>
          </material>
        </visual>
        <collision>
          <pose>0 0 0.1 0 0 0</pose>
          <geometry>
            <box size="0.5 0.5 0.2"/>
          </geometry>
        </collision>
        <inertial>
          <mass>50</mass>
          <pose>0 0 0.1 0 0 0</pose>
          <inertia>
            <ixx>0.1</ixx>
            <ixy>0</ixy>
            <ixz>0</ixz>
            <iyy>0.1</iyy>
            <iyz>0</iyz>
            <izz>0.1</izz>
          </inertia>
        </inertial>
      </link>
      <!-- Text label visualization would be added here in a real scenario -->
    </model>

  </world>
</sdf>
